#loc = loc("/root/triton/triton-cpu/./python/tutorials/02-fused-softmax-cpu.py":76:0)
module {
  tt.func public @softmax_kernel(%arg0: !tt.ptr<f32> {tt.divisibility = 16 : i32} loc("/root/triton/triton-cpu/./python/tutorials/02-fused-softmax-cpu.py":76:0), %arg1: !tt.ptr<f32> {tt.divisibility = 16 : i32} loc("/root/triton/triton-cpu/./python/tutorials/02-fused-softmax-cpu.py":76:0), %arg2: i32 {tt.divisibility = 16 : i32} loc("/root/triton/triton-cpu/./python/tutorials/02-fused-softmax-cpu.py":76:0), %arg3: i32 {tt.divisibility = 16 : i32} loc("/root/triton/triton-cpu/./python/tutorials/02-fused-softmax-cpu.py":76:0), %arg4: i32 {tt.divisibility = 16 : i32} loc("/root/triton/triton-cpu/./python/tutorials/02-fused-softmax-cpu.py":76:0)) attributes {noinline = false} {
    %cst = arith.constant 0.000000e+00 : f32 loc(#loc1)
    %cst_0 = arith.constant 0xFF800000 : f32 loc(#loc1)
    %c0_i32 = arith.constant 0 : i32 loc(#loc1)
    %c0 = arith.constant 0 : index loc(#loc1)
    %cst_1 = arith.constant dense<"0x000000000100000002000000030000000400000005000000060000000700000008000000090000000A0000000B0000000C0000000D0000000E0000000F000000100000001100000012000000130000001400000015000000160000001700000018000000190000001A0000001B0000001C0000001D0000001E0000001F000000200000002100000022000000230000002400000025000000260000002700000028000000290000002A0000002B0000002C0000002D0000002E0000002F000000300000003100000032000000330000003400000035000000360000003700000038000000390000003A0000003B0000003C0000003D0000003E0000003F000000400000004100000042000000430000004400000045000000460000004700000048000000490000004A0000004B0000004C0000004D0000004E0000004F000000500000005100000052000000530000005400000055000000560000005700000058000000590000005A0000005B0000005C0000005D0000005E0000005F000000600000006100000062000000630000006400000065000000660000006700000068000000690000006A0000006B0000006C0000006D0000006E0000006F000000700000007100000072000000730000007400000075000000760000007700000078000000790000007A0000007B0000007C0000007D0000007E0000007F000000800000008100000082000000830000008400000085000000860000008700000088000000890000008A0000008B0000008C0000008D0000008E0000008F000000900000009100000092000000930000009400000095000000960000009700000098000000990000009A0000009B0000009C0000009D0000009E0000009F000000A0000000A1000000A2000000A3000000A4000000A5000000A6000000A7000000A8000000A9000000AA000000AB000000AC000000AD000000AE000000AF000000B0000000B1000000B2000000B3000000B4000000B5000000B6000000B7000000B8000000B9000000BA000000BB000000BC000000BD000000BE000000BF000000C0000000C1000000C2000000C3000000C4000000C5000000C6000000C7000000C8000000C9000000CA000000CB000000CC000000CD000000CE000000CF000000D0000000D1000000D2000000D3000000D4000000D5000000D6000000D7000000D8000000D9000000DA000000DB000000DC000000DD000000DE000000DF000000E0000000E1000000E2000000E3000000E4000000E5000000E6000000E7000000E8000000E9000000EA000000EB000000EC000000ED000000EE000000EF000000F0000000F1000000F2000000F3000000F4000000F5000000F6000000F7000000F8000000F9000000FA000000FB000000FC000000FD000000FE000000FF000000000100000101000002010000030100000401000005010000060100000701000008010000090100000A0100000B0100000C0100000D0100000E0100000F010000100100001101000012010000130100001401000015010000160100001701000018010000190100001A0100001B0100001C0100001D0100001E0100001F010000200100002101000022010000230100002401000025010000260100002701000028010000290100002A0100002B0100002C0100002D0100002E0100002F010000300100003101000032010000330100003401000035010000360100003701000038010000390100003A0100003B0100003C0100003D0100003E0100003F010000400100004101000042010000430100004401000045010000460100004701000048010000490100004A0100004B0100004C0100004D0100004E0100004F010000500100005101000052010000530100005401000055010000560100005701000058010000590100005A0100005B0100005C0100005D0100005E0100005F010000600100006101000062010000630100006401000065010000660100006701000068010000690100006A0100006B0100006C0100006D0100006E0100006F010000700100007101000072010000730100007401000075010000760100007701000078010000790100007A0100007B0100007C0100007D0100007E0100007F010000800100008101000082010000830100008401000085010000860100008701000088010000890100008A0100008B0100008C0100008D0100008E0100008F010000900100009101000092010000930100009401000095010000960100009701000098010000990100009A0100009B0100009C0100009D0100009E0100009F010000A0010000A1010000A2010000A3010000A4010000A5010000A6010000A7010000A8010000A9010000AA010000AB010000AC010000AD010000AE010000AF010000B0010000B1010000B2010000B3010000B4010000B5010000B6010000B7010000B8010000B9010000BA010000BB010000BC010000BD010000BE010000BF010000C0010000C1010000C2010000C3010000C4010000C5010000C6010000C7010000C8010000C9010000CA010000CB010000CC010000CD010000CE010000CF010000D0010000D1010000D2010000D3010000D4010000D5010000D6010000D7010000D8010000D9010000DA010000DB010000DC010000DD010000DE010000DF010000E0010000E1010000E2010000E3010000E4010000E5010000E6010000E7010000E8010000E9010000EA010000EB010000EC010000ED010000EE010000EF010000F0010000F1010000F2010000F3010000F4010000F5010000F6010000F7010000F8010000F9010000FA010000FB010000FC010000FD010000FE010000FF010000000200000102000002020000030200000402000005020000060200000702000008020000090200000A0200000B0200000C0200000D0200000E0200000F020000100200001102000012020000130200001402000015020000160200001702000018020000190200001A0200001B0200001C0200001D0200001E0200001F020000200200002102000022020000230200002402000025020000260200002702000028020000290200002A0200002B0200002C0200002D0200002E0200002F020000300200003102000032020000330200003402000035020000360200003702000038020000390200003A0200003B0200003C0200003D0200003E0200003F020000400200004102000042020000430200004402000045020000460200004702000048020000490200004A0200004B0200004C0200004D0200004E0200004F020000500200005102000052020000530200005402000055020000560200005702000058020000590200005A0200005B0200005C0200005D0200005E0200005F020000600200006102000062020000630200006402000065020000660200006702000068020000690200006A0200006B0200006C0200006D0200006E0200006F020000700200007102000072020000730200007402000075020000760200007702000078020000790200007A0200007B0200007C0200007D0200007E0200007F020000800200008102000082020000830200008402000085020000860200008702000088020000890200008A0200008B0200008C0200008D0200008E0200008F020000900200009102000092020000930200009402000095020000960200009702000098020000990200009A0200009B0200009C0200009D0200009E0200009F020000A0020000A1020000A2020000A3020000A4020000A5020000A6020000A7020000A8020000A9020000AA020000AB020000AC020000AD020000AE020000AF020000B0020000B1020000B2020000B3020000B4020000B5020000B6020000B7020000B8020000B9020000BA020000BB020000BC020000BD020000BE020000BF020000C0020000C1020000C2020000C3020000C4020000C5020000C6020000C7020000C8020000C9020000CA020000CB020000CC020000CD020000CE020000CF020000D0020000D1020000D2020000D3020000D4020000D5020000D6020000D7020000D8020000D9020000DA020000DB020000DC020000DD020000DE020000DF020000E0020000E1020000E2020000E3020000E4020000E5020000E6020000E7020000E8020000E9020000EA020000EB020000EC020000ED020000EE020000EF020000F0020000F1020000F2020000F3020000F4020000F5020000F6020000F7020000F8020000F9020000FA020000FB020000FC020000FD020000FE020000FF020000000300000103000002030000030300000403000005030000060300000703000008030000090300000A0300000B0300000C0300000D0300000E0300000F030000100300001103000012030000130300001403000015030000160300001703000018030000190300001A0300001B0300001C0300001D0300001E0300001F030000200300002103000022030000230300002403000025030000260300002703000028030000290300002A0300002B0300002C0300002D0300002E0300002F030000300300003103000032030000330300003403000035030000360300003703000038030000390300003A0300003B0300003C0300003D0300003E0300003F030000400300004103000042030000430300004403000045030000460300004703000048030000490300004A0300004B0300004C0300004D0300004E0300004F030000500300005103000052030000530300005403000055030000560300005703000058030000590300005A0300005B0300005C0300005D0300005E0300005F030000600300006103000062030000630300006403000065030000660300006703000068030000690300006A0300006B0300006C0300006D0300006E0300006F030000700300007103000072030000730300007403000075030000760300007703000078030000790300007A0300007B0300007C0300007D0300007E0300007F030000800300008103000082030000830300008403000085030000860300008703000088030000890300008A0300008B0300008C0300008D0300008E0300008F030000900300009103000092030000930300009403000095030000960300009703000098030000990300009A0300009B0300009C0300009D0300009E0300009F030000A0030000A1030000A2030000A3030000A4030000A5030000A6030000A7030000A8030000A9030000AA030000AB030000AC030000AD030000AE030000AF030000B0030000B1030000B2030000B3030000B4030000B5030000B6030000B7030000B8030000B9030000BA030000BB030000BC030000BD030000BE030000BF030000C0030000C1030000C2030000C3030000C4030000C5030000C6030000C7030000C8030000C9030000CA030000CB030000CC030000CD030000CE030000CF030000D0030000D1030000D2030000D3030000D4030000D5030000D6030000D7030000D8030000D9030000DA030000DB030000DC030000DD030000DE030000DF030000E0030000E1030000E2030000E3030000E4030000E5030000E6030000E7030000E8030000E9030000EA030000EB030000EC030000ED030000EE030000EF030000F0030000F1030000F2030000F3030000F4030000F5030000F6030000F7030000F8030000F9030000FA030000FB030000FC030000FD030000FE030000FF030000000400000104000002040000030400000404000005040000060400000704000008040000090400000A0400000B0400000C0400000D0400000E0400000F040000100400001104000012040000130400001404000015040000160400001704000018040000190400001A0400001B0400001C0400001D0400001E0400001F040000200400002104000022040000230400002404000025040000260400002704000028040000290400002A0400002B0400002C0400002D0400002E0400002F040000300400003104000032040000330400003404000035040000360400003704000038040000390400003A0400003B0400003C0400003D0400003E0400003F040000400400004104000042040000430400004404000045040000460400004704000048040000490400004A0400004B0400004C0400004D0400004E0400004F040000500400005104000052040000530400005404000055040000560400005704000058040000590400005A0400005B0400005C0400005D0400005E0400005F040000600400006104000062040000630400006404000065040000660400006704000068040000690400006A0400006B0400006C0400006D0400006E0400006F040000700400007104000072040000730400007404000075040000760400007704000078040000790400007A0400007B0400007C0400007D0400007E0400007F040000800400008104000082040000830400008404000085040000860400008704000088040000890400008A0400008B0400008C0400008D0400008E0400008F040000900400009104000092040000930400009404000095040000960400009704000098040000990400009A0400009B0400009C0400009D0400009E0400009F040000A0040000A1040000A2040000A3040000A4040000A5040000A6040000A7040000A8040000A9040000AA040000AB040000AC040000AD040000AE040000AF040000B0040000B1040000B2040000B3040000B4040000B5040000B6040000B7040000B8040000B9040000BA040000BB040000BC040000BD040000BE040000BF040000C0040000C1040000C2040000C3040000C4040000C5040000C6040000C7040000C8040000C9040000CA040000CB040000CC040000CD040000CE040000CF040000D0040000D1040000D2040000D3040000D4040000D5040000D6040000D7040000D8040000D9040000DA040000DB040000DC040000DD040000DE040000DF040000E0040000E1040000E2040000E3040000E4040000E5040000E6040000E7040000E8040000E9040000EA040000EB040000EC040000ED040000EE040000EF040000F0040000F1040000F2040000F3040000F4040000F5040000F6040000F7040000F8040000F9040000FA040000FB040000FC040000FD040000FE040000FF040000000500000105000002050000030500000405000005050000060500000705000008050000090500000A0500000B0500000C0500000D0500000E0500000F050000100500001105000012050000130500001405000015050000160500001705000018050000190500001A0500001B0500001C0500001D0500001E0500001F050000200500002105000022050000230500002405000025050000260500002705000028050000290500002A0500002B0500002C0500002D0500002E0500002F050000300500003105000032050000330500003405000035050000360500003705000038050000390500003A0500003B0500003C0500003D0500003E0500003F050000400500004105000042050000430500004405000045050000460500004705000048050000490500004A0500004B0500004C0500004D0500004E0500004F050000500500005105000052050000530500005405000055050000560500005705000058050000590500005A0500005B0500005C0500005D0500005E0500005F050000600500006105000062050000630500006405000065050000660500006705000068050000690500006A0500006B0500006C0500006D0500006E0500006F050000700500007105000072050000730500007405000075050000760500007705000078050000790500007A0500007B0500007C0500007D0500007E0500007F050000800500008105000082050000830500008405000085050000860500008705000088050000890500008A0500008B0500008C0500008D0500008E0500008F050000900500009105000092050000930500009405000095050000960500009705000098050000990500009A0500009B0500009C0500009D0500009E0500009F050000A0050000A1050000A2050000A3050000A4050000A5050000A6050000A7050000A8050000A9050000AA050000AB050000AC050000AD050000AE050000AF050000B0050000B1050000B2050000B3050000B4050000B5050000B6050000B7050000B8050000B9050000BA050000BB050000BC050000BD050000BE050000BF050000C0050000C1050000C2050000C3050000C4050000C5050000C6050000C7050000C8050000C9050000CA050000CB050000CC050000CD050000CE050000CF050000D0050000D1050000D2050000D3050000D4050000D5050000D6050000D7050000D8050000D9050000DA050000DB050000DC050000DD050000DE050000DF050000E0050000E1050000E2050000E3050000E4050000E5050000E6050000E7050000E8050000E9050000EA050000EB050000EC050000ED050000EE050000EF050000F0050000F1050000F2050000F3050000F4050000F5050000F6050000F7050000F8050000F9050000FA050000FB050000FC050000FD050000FE050000FF050000000600000106000002060000030600000406000005060000060600000706000008060000090600000A0600000B0600000C0600000D0600000E0600000F060000100600001106000012060000130600001406000015060000160600001706000018060000190600001A0600001B0600001C0600001D0600001E0600001F060000200600002106000022060000230600002406000025060000260600002706000028060000290600002A0600002B0600002C0600002D0600002E0600002F060000300600003106000032060000330600003406000035060000360600003706000038060000390600003A0600003B0600003C0600003D0600003E0600003F060000400600004106000042060000430600004406000045060000460600004706000048060000490600004A0600004B0600004C0600004D0600004E0600004F060000500600005106000052060000530600005406000055060000560600005706000058060000590600005A0600005B0600005C0600005D0600005E0600005F060000600600006106000062060000630600006406000065060000660600006706000068060000690600006A0600006B0600006C0600006D0600006E0600006F060000700600007106000072060000730600007406000075060000760600007706000078060000790600007A0600007B0600007C0600007D0600007E0600007F060000800600008106000082060000830600008406000085060000860600008706000088060000890600008A0600008B0600008C0600008D0600008E0600008F060000900600009106000092060000930600009406000095060000960600009706000098060000990600009A0600009B0600009C0600009D0600009E0600009F060000A0060000A1060000A2060000A3060000A4060000A5060000A6060000A7060000A8060000A9060000AA060000AB060000AC060000AD060000AE060000AF060000B0060000B1060000B2060000B3060000B4060000B5060000B6060000B7060000B8060000B9060000BA060000BB060000BC060000BD060000BE060000BF060000C0060000C1060000C2060000C3060000C4060000C5060000C6060000C7060000C8060000C9060000CA060000CB060000CC060000CD060000CE060000CF060000D0060000D1060000D2060000D3060000D4060000D5060000D6060000D7060000D8060000D9060000DA060000DB060000DC060000DD060000DE060000DF060000E0060000E1060000E2060000E3060000E4060000E5060000E6060000E7060000E8060000E9060000EA060000EB060000EC060000ED060000EE060000EF060000F0060000F1060000F2060000F3060000F4060000F5060000F6060000F7060000F8060000F9060000FA060000FB060000FC060000FD060000FE060000FF060000000700000107000002070000030700000407000005070000060700000707000008070000090700000A0700000B0700000C0700000D0700000E0700000F070000100700001107000012070000130700001407000015070000160700001707000018070000190700001A0700001B0700001C0700001D0700001E0700001F070000200700002107000022070000230700002407000025070000260700002707000028070000290700002A0700002B0700002C0700002D0700002E0700002F070000300700003107000032070000330700003407000035070000360700003707000038070000390700003A0700003B0700003C0700003D0700003E0700003F070000400700004107000042070000430700004407000045070000460700004707000048070000490700004A0700004B0700004C0700004D0700004E0700004F070000500700005107000052070000530700005407000055070000560700005707000058070000590700005A0700005B0700005C0700005D0700005E0700005F070000600700006107000062070000630700006407000065070000660700006707000068070000690700006A0700006B0700006C0700006D0700006E0700006F070000700700007107000072070000730700007407000075070000760700007707000078070000790700007A0700007B0700007C0700007D0700007E0700007F070000800700008107000082070000830700008407000085070000860700008707000088070000890700008A0700008B0700008C0700008D0700008E0700008F070000900700009107000092070000930700009407000095070000960700009707000098070000990700009A0700009B0700009C0700009D0700009E0700009F070000A0070000A1070000A2070000A3070000A4070000A5070000A6070000A7070000A8070000A9070000AA070000AB070000AC070000AD070000AE070000AF070000B0070000B1070000B2070000B3070000B4070000B5070000B6070000B7070000B8070000B9070000BA070000BB070000BC070000BD070000BE070000BF070000C0070000C1070000C2070000C3070000C4070000C5070000C6070000C7070000C8070000C9070000CA070000CB070000CC070000CD070000CE070000CF070000D0070000D1070000D2070000D3070000D4070000D5070000D6070000D7070000D8070000D9070000DA070000DB070000DC070000DD070000DE070000DF070000E0070000E1070000E2070000E3070000E4070000E5070000E6070000E7070000E8070000E9070000EA070000EB070000EC070000ED070000EE070000EF070000F0070000F1070000F2070000F3070000F4070000F5070000F6070000F7070000F8070000F9070000FA070000FB070000FC070000FD070000FE070000FF070000"> : vector<2048xi32> loc(#loc1)
    %cst_2 = arith.constant dense<0xFF800000> : vector<2048xf32> loc(#loc1)
    %0 = tt.get_program_id x : i32 loc(#loc2)
    %1 = arith.muli %0, %arg2 : i32 loc(#loc3)
    %2 = tt.addptr %arg1, %1 : !tt.ptr<f32>, i32 loc(#loc4)
    %3 = vector.splat %arg4 : vector<2048xi32> loc(#loc5)
    %4 = arith.cmpi sgt, %3, %cst_1 : vector<2048xi32> loc(#loc5)
    %5 = tt.addptr %2, %c0_i32 : !tt.ptr<f32>, i32 loc(#loc6)
    %6 = triton_cpu.ptr_to_memref %5 : <f32> -> memref<2048xf32> loc(#loc7)
    %7 = vector.maskedload %6[%c0], %4, %cst_2 : memref<2048xf32>, vector<2048xi1>, vector<2048xf32> into vector<2048xf32> loc(#loc7)
    %8 = vector.reduction <maxnumf>, %7, %cst_0 : vector<2048xf32> into f32 loc(#loc20)
    %9 = vector.splat %8 : vector<2048xf32> loc(#loc10)
    %10 = arith.subf %7, %9 : vector<2048xf32> loc(#loc10)
    %11 = math.exp %10 : vector<2048xf32> loc(#loc11)
    %12 = vector.reduction <add>, %11, %cst : vector<2048xf32> into f32 loc(#loc21)
    %13 = vector.splat %12 : vector<2048xf32> loc(#loc14)
    %14 = arith.divf %11, %13 : vector<2048xf32> loc(#loc14)
    %15 = arith.muli %0, %arg3 : i32 loc(#loc15)
    %16 = tt.addptr %arg0, %15 : !tt.ptr<f32>, i32 loc(#loc16)
    %17 = tt.addptr %16, %c0_i32 : !tt.ptr<f32>, i32 loc(#loc17)
    %18 = triton_cpu.ptr_to_memref %17 : <f32> -> memref<2048xf32> loc(#loc18)
    vector.maskedstore %18[%c0], %4, %14 : memref<2048xf32>, vector<2048xi1>, vector<2048xf32> loc(#loc18)
    tt.return loc(#loc19)
  } loc(#loc)
} loc(#loc)
#loc1 = loc(unknown)
#loc2 = loc("/root/triton/triton-cpu/./python/tutorials/02-fused-softmax-cpu.py":78:28)
#loc3 = loc("/root/triton/triton-cpu/./python/tutorials/02-fused-softmax-cpu.py":80:42)
#loc4 = loc("/root/triton/triton-cpu/./python/tutorials/02-fused-softmax-cpu.py":80:32)
#loc5 = loc("/root/triton/triton-cpu/./python/tutorials/02-fused-softmax-cpu.py":86:49)
#loc6 = loc("/root/triton/triton-cpu/./python/tutorials/02-fused-softmax-cpu.py":84:33)
#loc7 = loc("/root/triton/triton-cpu/./python/tutorials/02-fused-softmax-cpu.py":86:18)
#loc8 = loc("/root/triton/triton-cpu/python/triton/language/standard.py":184:40)
#loc9 = loc("/root/triton/triton-cpu/./python/tutorials/02-fused-softmax-cpu.py":88:33)
#loc10 = loc("/root/triton/triton-cpu/./python/tutorials/02-fused-softmax-cpu.py":88:26)
#loc11 = loc("/root/triton/triton-cpu/./python/tutorials/02-fused-softmax-cpu.py":90:23)
#loc12 = loc("/root/triton/triton-cpu/python/triton/language/standard.py":267:36)
#loc13 = loc("/root/triton/triton-cpu/./python/tutorials/02-fused-softmax-cpu.py":91:25)
#loc14 = loc("/root/triton/triton-cpu/./python/tutorials/02-fused-softmax-cpu.py":92:33)
#loc15 = loc("/root/triton/triton-cpu/./python/tutorials/02-fused-softmax-cpu.py":94:50)
#loc16 = loc("/root/triton/triton-cpu/./python/tutorials/02-fused-softmax-cpu.py":94:40)
#loc17 = loc("/root/triton/triton-cpu/./python/tutorials/02-fused-softmax-cpu.py":95:41)
#loc18 = loc("/root/triton/triton-cpu/./python/tutorials/02-fused-softmax-cpu.py":96:26)
#loc19 = loc("/root/triton/triton-cpu/./python/tutorials/02-fused-softmax-cpu.py":96:4)
#loc20 = loc(callsite(#loc8 at #loc9))
#loc21 = loc(callsite(#loc12 at #loc13))
